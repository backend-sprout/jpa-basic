# 객체지향 쿼리 언어  

`JPA`에서는 아래와 같은 방법으로 객체를 조회할 수 있다.     

* 식별자로 조회 : `EntityManager.find()` 
* 객체 그래프 탐색 : `조회된객체.getSomeThing()`   
       
하지만, 위 기능만으로 온전한 애플리케이션을 개발하기는 힘들다.        
예를 들어, `나이가 30 이상인 회원`, `키가 170 이상인 회원`과 같이        
`특정 조건`에 대한 `상세 정보`를 검색하고자 하면 이를 표현할 방법이 없기 때문이다.      
         
물론, 모든 값을 가져와서 애플리케이션단에서 처리를 할 수 는 있겠지만    
그렇다고 모든 회원 엔티티를 메모리에 올려두고 검색하는 것은 현실성이 없다.  
**결국, DB에 있는 데이터를 SQL을 이용하여 최대한 걸러서 조회해야한다.**   
     
ORM을 사용하면 DB 테이블이 아닌 엔티티 객체를 대상으로 개발을 한다.       
그렇기에 검색도 테이블이 아닌 엔티티 객체를 대상으로 하는 방법이 필요해졌고      
이러한 문제를 해결하기 위해 `JPQL`이 만들어졌다.      
       
**JPQL 특징**
* 테이블이 아닌 객체를 대상으로 검색하는 객체지향 쿼리다.    
* SQL을 추상화해서 특정 DB SQL에 의존하지 않는다.   
       
`SQL` 은 오롯이 `DB 테이블`을 대상으로 하는 `데이터 중심의 쿼리`이다.          
`JPQL` 은 오롯이 `엔티티 객체`를 대상으로 하는 `객체지향 쿼리`이다.          

`JPQL`을 한마디로 정의하면 `객체지향 SQL`이다.   
`SQL`과 문법이 매우 비슷하기에 몇 가지 차이점만 이해하면 쉽게 적응가능하다.     

`JPA`는 `JPQL` 말고도 다양한 검색 방법을 제공한다.  

**JPA 공식 검색 기능**   
* **JPQL**        
* **Criteria 쿼리 :** `JPQL`을 편하게 작성하도록 도와주는 `API`, 빌더 클래스 모음             
* **네이티브 SQL :** `JPA`에서 `JPQL` 대신 직접 `SQL`을 사용할 수 있다.          

**JPA 비공식 검색 기능**   
* **QueryDSL :** Criteria 쿼리처럼 JPQL을 편하게 작성라도록 도와주는 빌더 클래스 모음,   
    비표준 오픈소스 프레임워크이다.    
* **JDBC, MyBatis 같은 SQL 매퍼 프레이워크 :** 필요하면 JDBC를 직접 사용할 수 있다.    

## JPQL 소개  
* **JPQL은 엔티티 객체를 조회하는 객체지향 쿼리다.**    
  문법은 `SQL`과 비슷하고 `ANSI 표준 SQL`이 제공하는 기능을 유사하게 지원한다.        
* **`JPQL`은 SQL을 추상화해서 `특정 DB`에 의존하지 않는다.**   
  그렇기에 DB 방언(dialect)에 대한 설정만 바꿔주기만 하면 코드의 변경없이 활용가능하다.     
* **JPQL은 SQL보다 간결하다.**  
  `엔티티 직접 조회`, `묵시적 조인`, `다형성 지원`으로 `SQL`보다 코드가 간결하다.     

**Member 엔티티**
```java
@Entity(name = "Member")   
public class Member {
    
    @Column(name = "name")  
    private String username;
    // ...
}
```
   
**JPQL 사용**     
```java
String jqpl = "select m from Member as m where m.username = 'kim'";
List<Member> resultList = em.createQuery(jpql, Member.class).getResultList();
```     
위 코드는 `회원 이름이 kim`인 **엔티티를 조회한다.**         
   
* `JPQL` 에서 `Member`는 **엔티티 이름이다.(영속성 컨텍스트에 들어가는 엔티티의 이름, @Entity(name=""))**   
* `m.username` 은 테이블 컬럼명이 아니라 **엔티티 객체의 필드명이다.(컬럼명이 아닌 필드명이다.)**     




 


  
   



















